{"ast":null,"code":"var _jsxFileName = \"c:\\\\dnd-campaign-site\\\\DND\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Routes, Route, Navigate, useNavigate } from 'react-router-dom';\nimport { supabase } from './supabaseClient';\nimport IndexPage from './pages/IndexPage';\nimport LoginPage from './pages/LoginPage';\nimport InventoryGrid from './components/InventoryGrid';\nimport AdminDashboard from './pages/AdminDashboard';\nimport Map from './Map'; // or wherever your map lives\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [session, setSession] = useState(null);\n  const [role, setRole] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const fetchSession = async () => {\n      const {\n        data: {\n          session\n        }\n      } = await supabase.auth.getSession();\n      setSession(session);\n      setLoading(false);\n      if (session) {\n        const {\n          user\n        } = session;\n        const {\n          data,\n          error\n        } = await supabase.from('user_profiles').select('role').eq('id', user.id).single();\n        if (error) console.error('Role fetch error:', error);else setRole(data.role);\n      }\n    };\n    fetchSession();\n    const {\n      data: listener\n    } = supabase.auth.onAuthStateChange((_event, session) => {\n      setSession(session);\n      if (session !== null && session !== void 0 && session.user) {\n        supabase.from('user_profiles').select('role').eq('id', session.user.id).single().then(({\n          data\n        }) => {\n          var _data$role;\n          return setRole((_data$role = data === null || data === void 0 ? void 0 : data.role) !== null && _data$role !== void 0 ? _data$role : null);\n        });\n      } else {\n        setRole(null);\n      }\n    });\n    return () => {\n      listener.subscription.unsubscribe();\n    };\n  }, []);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 text-white\",\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Routes, {\n    children: [/*#__PURE__*/_jsxDEV(Route, {\n      path: \"/\",\n      element: /*#__PURE__*/_jsxDEV(IndexPage, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 32\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Route, {\n      path: \"/login\",\n      element: /*#__PURE__*/_jsxDEV(LoginPage, {\n        onLogin: () => navigate('/')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 37\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Route, {\n      path: \"/inventory\",\n      element: session ? /*#__PURE__*/_jsxDEV(InventoryGrid, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 28\n      }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n        to: \"/login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 48\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Route, {\n      path: \"/admin\",\n      element: session && role === 'admin' ? /*#__PURE__*/_jsxDEV(AdminDashboard, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 41\n      }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n        to: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 62\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Route, {\n      path: \"/map\",\n      element: session ? /*#__PURE__*/_jsxDEV(Map, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 28\n      }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n        to: \"/login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 38\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"nUWKQSbc9YsvigfwjT1FvgqBfC8=\", false, function () {\n  return [useNavigate];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","Routes","Route","Navigate","useNavigate","supabase","IndexPage","LoginPage","InventoryGrid","AdminDashboard","Map","jsxDEV","_jsxDEV","App","_s","session","setSession","role","setRole","loading","setLoading","navigate","fetchSession","data","auth","getSession","user","error","from","select","eq","id","single","console","listener","onAuthStateChange","_event","then","_data$role","subscription","unsubscribe","className","children","fileName","_jsxFileName","lineNumber","columnNumber","path","element","onLogin","to","_c","$RefreshReg$"],"sources":["c:/dnd-campaign-site/DND/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Routes, Route, Navigate, useNavigate } from 'react-router-dom';\r\nimport { supabase } from './supabaseClient';\r\n\r\nimport IndexPage from './pages/IndexPage';\r\nimport LoginPage from './pages/LoginPage';\r\nimport InventoryGrid from './components/InventoryGrid';\r\nimport AdminDashboard from './pages/AdminDashboard';\r\nimport Map from './Map'; // or wherever your map lives\r\n\r\nfunction App() {\r\n  const [session, setSession] = useState(null);\r\n  const [role, setRole] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchSession = async () => {\r\n      const {\r\n        data: { session },\r\n      } = await supabase.auth.getSession();\r\n\r\n      setSession(session);\r\n      setLoading(false);\r\n\r\n      if (session) {\r\n        const { user } = session;\r\n        const { data, error } = await supabase\r\n          .from('user_profiles')\r\n          .select('role')\r\n          .eq('id', user.id)\r\n          .single();\r\n\r\n        if (error) console.error('Role fetch error:', error);\r\n        else setRole(data.role);\r\n      }\r\n    };\r\n\r\n    fetchSession();\r\n\r\n    const { data: listener } = supabase.auth.onAuthStateChange((_event, session) => {\r\n      setSession(session);\r\n      if (session?.user) {\r\n        supabase\r\n          .from('user_profiles')\r\n          .select('role')\r\n          .eq('id', session.user.id)\r\n          .single()\r\n          .then(({ data }) => setRole(data?.role ?? null));\r\n      } else {\r\n        setRole(null);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      listener.subscription.unsubscribe();\r\n    };\r\n  }, []);\r\n\r\n  if (loading) return <div className=\"p-6 text-white\">Loading...</div>;\r\n\r\n  return (\r\n    <Routes>\r\n      <Route path=\"/\" element={<IndexPage />} />\r\n      <Route path=\"/login\" element={<LoginPage onLogin={() => navigate('/')} />} />\r\n      <Route\r\n        path=\"/inventory\"\r\n        element={session ? <InventoryGrid /> : <Navigate to=\"/login\" />}\r\n      />\r\n      <Route\r\n        path=\"/admin\"\r\n        element={\r\n          session && role === 'admin' ? <AdminDashboard /> : <Navigate to=\"/\" />\r\n        }\r\n      />\r\n      <Route\r\n        path=\"/map\"\r\n        element={session ? <Map /> : <Navigate to=\"/login\" />}\r\n      />\r\n    </Routes>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}